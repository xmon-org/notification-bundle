services:
    _defaults:
        autowire: true
        autoconfigure: true

    # Channel Registry (Service Locator)
    Xmon\NotificationBundle\Channel\ChannelRegistry:
        arguments:
            $channels: [] # Populated by ChannelCompilerPass

    # Template Renderer
    Xmon\NotificationBundle\Service\TemplateRenderer: ~

    # Notification Service (Main orchestrator)
    Xmon\NotificationBundle\Service\NotificationService:
        arguments:
            $defaultChannels: [] # Configured in Extension

    # Email Channel
    Xmon\NotificationBundle\Channel\EmailChannel:
        arguments:
            $from: ''
            $fromName: ''
        tags:
            - { name: 'xmon_notification.channel' }
            - { name: 'monolog.logger', channel: 'notification' }

    # Telegram Channel
    Xmon\NotificationBundle\Channel\TelegramChannel:
        arguments:
            $config: []
        tags:
            - { name: 'xmon_notification.channel' }
            - { name: 'monolog.logger', channel: 'notification' }

    # Telegram Service (Advanced API: photos, buttons, webhooks)
    Xmon\NotificationBundle\Telegram\TelegramService:
        arguments:
            $config: []
        tags:
            - { name: 'monolog.logger', channel: 'notification' }

    # Telegram Webhook Controller
    Xmon\NotificationBundle\Controller\TelegramWebhookController:
        arguments:
            $webhookSecret: null
        tags:
            - { name: 'controller.service_arguments' }
            - { name: 'monolog.logger', channel: 'notification' }
